<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ocean King 3 Multi-Detector</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #111;
      color: white;
      margin: 0;
      padding: 0;
    }
    h1 {
      background-color: #222;
      padding: 20px;
      margin: 0;
    }
    video, canvas {
      border: 1px solid #444;
      margin-top: 10px;
      max-width: 100%;
    }
    #status {
      font-size: 1.6em;
      margin: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Ocean King 3 Multi-Detector</h1>
  <video id="video" width="640" height="480" autoplay playsinline muted></video>
  <canvas id="canvas" width="640" height="480"></canvas>
  <div id="status">Status: Initializing...</div>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const statusDiv = document.getElementById('status');

    // Use the back camera if possible
    navigator.mediaDevices.getUserMedia({
      video: { facingMode: { ideal: "environment" } },
      audio: false
    })
    .then(stream => {
      video.srcObject = stream;
      video.play();
    })
    .catch(err => {
      console.error("Camera error:", err);
      statusDiv.textContent = "‚ùå Cannot access camera: " + err;
    });

    function detectColors(frame) {
      let blue = 0, green = 0, red = 0, yellow = 0;
      const data = frame.data;

      for (let i = 0; i < data.length; i += 4) {
        const r = data[i];
        const g = data[i + 1];
        const b = data[i + 2];

        // Detect Blue (e.g., bullets)
        if (b > 100 && b > r * 1.5 && b > g * 1.5) {
          blue++;
          data[i] = 0;
          data[i + 1] = 0;
          data[i + 2] = 255;
        }

        // Detect Green (e.g., fish)
        else if (g > 100 && g > r * 1.5 && g > b * 1.5) {
          green++;
          data[i] = 0;
          data[i + 1] = 255;
          data[i + 2] = 0;
        }

        // Detect Red (e.g., bosses)
        else if (r > 120 && r > g * 1.5 && r > b * 1.5) {
          red++;
          data[i] = 255;
          data[i + 1] = 0;
          data[i + 2] = 0;
        }

        // Detect Yellow (e.g., coins or payout)
        else if (r > 120 && g > 120 && b < 80) {
          yellow++;
          data[i] = 255;
          data[i + 1] = 255;
          data[i + 2] = 0;
        }
      }

      return { blue, green, red, yellow };
    }

    function processFrame() {
      if (video.readyState === video.HAVE_ENOUGH_DATA) {
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);

        const { blue, green, red, yellow } = detectColors(frame);
        ctx.putImageData(frame, 0, 0);

        // Show counts and prediction logic
        let statusMsg = `üîµ Bullets: ${blue} | üü¢ Fish: ${green} | üî¥ Bosses: ${red} | üü° Coins: ${yellow}`;

        if (blue > 10000 || red > 2000 || yellow > 1000) {
          statusMsg += " ‚Äî üî• HOT!";
          statusDiv.style.color = "lime";
        } else {
          statusMsg += " ‚Äî ‚ùÑÔ∏è Cold";
          statusDiv.style.color = "skyblue";
        }

        statusDiv.textContent = statusMsg;
      }

      requestAnimationFrame(processFrame);
    }

    video.addEventListener('play', () => {
      processFrame();
    });
  </script>
</body>
</html>
